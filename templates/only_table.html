{% extends "dashboard.html" %}
{% block content %}
{% if not message %}
    <form action="{{url_for('table_selected')}}" method="POST">
      <div>
        <label for="db_table"><b>Select the data you're entering:</b></label>
        <select id="db_table" name="db_table">
          <option>T_Passenger_Arrival_UP</option>
          <option>T_Passenger_Arrival_DN</option>
          <option>T_Fare_UP</option>
          <option>T_Fare_DN</option>
          <option>T_Alighting_Rate_UP</option>
          <option>T_Alighting_Rate_DN</option>
          <option>T_TraveTimeUP_ANN</option>
          <option>T_TravelTimeDN_ANN</option>
        </select>
        <button type="submit" value="submit">Submit</button>
      </div>
    </form>
    {% if selected_table %}
    <h4>{{selected_table}}</h4>
    <form action="{{url_for('table_filled')}}" method="POST" enctype="multipart/form-data">
        <table>
          <thead>
            <tr>
              <th> </th>
              {%for n in stops_list%}
              <th>{{n}}</th>
              {%endfor%}
            </tr>
          </thead>
            {% for i in range(rows|length) %}
            <tr>
              <td>{{rowheader[i]}}</td>
              {%for n in range(stop_ids|length) %}
                {% if db_data %}
                <td><input type="number" name="{{stop_ids[n]}}{{'_'}}{{rows[i]}}" value="{{db_data[n][i]}}"/></td>
                {% endif %}
                {% if not db_data %}
                <td><input type="number" name="{{stop_ids[n]}}{{'_'}}{{rows[i]}}" value="0"/></td>
                {% endif %}
              {% endfor %}
              <td><button id="copy" type="button">=</button></td>
            </tr>
            {% endfor %}
        </table>
      <div>
          <input id="selected_table" name="selected_table" value="{{selected_table}}" hidden>
          <button type="submit" value="Submit">Save</button>
          <button type="submit" formaction="{{url_for('clear_table')}}" value="Clear">Clear</button>
          <button type="submit" formaction="{{url_for('retrieve_data')}}" value="Retrieve">Retrieve</button>
          <button type="submit" formaction="{{url_for('download_csv_data')}}" value="Download" >Download CSV</button>
          <input type="file" id="csvfile" name="csvfile">
          <button type="submit" formaction="{{url_for('upload_csv_data')}}" value="Upload">Upload CSV</button>
      </div>
    </form>
    {% endif %}
{% endif%}
{% if message %}
{{message}}
{% endif%}
{% endblock %}

{% block foot %}
<script>
// Get all the buttons in the table
const buttons = document.querySelectorAll('button');

// Loop through each button
buttons.forEach((button) => {
  // Add a click event listener to each button
  button.addEventListener('click', () => {
    // Get the current row
    const currentRow = button.parentNode.parentNode;

    // Get the previous row
    const previousRow = currentRow.previousElementSibling;

    // Get all input elements in the previous row
    const previousInputs = previousRow.querySelectorAll('input');

    // Get all input elements in the current row
    const currentInputs = currentRow.querySelectorAll('input');

    // Loop through each input element in the previous row
    previousInputs.forEach((input, index) => {
      // Get the value of the input
      const value = input.value;

      // Get the corresponding input element in the current row
      const currentInput = currentInputs[index];

      // Set the value of the current input to the value of the previous input
      currentInput.value = value;
    });
  });
});

</script>
{% endblock %}

