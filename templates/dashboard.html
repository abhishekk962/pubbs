<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Test Layout</title>
    <link rel="stylesheet" href="{{url_for('static',filename='main.css')}}">
    {% block head %}
    {% endblock %}
  </head>
  <body>
    <header>
      <div class="header-brand">
        <b>MOHUA</b>
        <b>PUBBS</b>
      </div>
      <div class="header-buttons">
        <button type="button">Login</button>
        <button type="button">Sign Up</button>
      </div>
    </header>
    <nav>
      <form>
        <button type="submit" formaction="{{url_for('busroute')}}">Bus Route</button>
        <button type="submit" formaction="{{url_for('stop_details')}}">Stop Details</button>
        <button type="submit" formaction="{{url_for('route_details')}}">Build Route</button>
        <button type="submit" formaction="{{url_for('stop_char')}}">Stop Characteristics</button>
        <button type="submit" formaction="{{url_for('table_details')}}">Table Details</button>
        <button type="submit" formaction="{{url_for('ols_details')}}">OLS Details</button>
        <button type="submit" formaction="{{url_for('constraints_details')}}">Constraints</button>
        <button type="submit" formaction="{{url_for('service_details')}}">Service Details</button>
        <button type="submit" formaction="{{url_for('ga_params')}}">GA Params</button>
        <button type="submit" formaction="{{url_for('scheduling_details')}}">Scheduling Details</button>
        <button type="submit" formaction="{{url_for('buses')}}">Buses</button>
        <button type="submit" formaction="{{url_for('scheduling')}}">Scheduling</button>
      </form>
    </nav>
    <div class="page-body">
      <div class="sidebar">
        <a href="{{url_for('frequency')}}">Frequency Optimisation</a>
        <div id="status">
        </div>
      </div>
      <div class="content">
        {% block content %}
        {% endblock %}
      </div>
    </div>
    {% block foot %}
    {% endblock %}
    <script>
      // Fetch the JSON data from the Flask endpoint
      fetch('/status-display')
        .then(response => response.json())
        .then(data => {
          // Iterate over the keys in the JSON data
          for (let key in data) {
            // Create a new <p> element for each key
            let p = document.createElement('p');

            // Set the text content of the <p> element to the key
            p.textContent = key;

            // Set the color of the <p> element based on the value of the key
            if (data[key] == 1) {
              p.style.color = 'blue';
            } else if (data[key] > 0){
              p.style.color = 'red';
              p.textContent = p.textContent + ' ' + Math.round(data[key]*100) + '%'
            } else {
              p.style.color = 'red';
            }

            // Append the <p> element to the document body
            document.getElementById('status').appendChild(p);
          }
        })
        .catch(error => {
          console.error('Error:', error);
        });
    </script>
  </body>
</html>